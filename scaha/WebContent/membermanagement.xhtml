<!DOCTYPE html>
<html lang="en"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"
>

	<!-- 
	
	This view is designed to manager memberships.   A single account can manage several memberships (in the family).
	
	Right now.. the only way to create a membership is to first start with a USA hockey number for the given master season.
	
	Eventually, we will allow the user to select an existing sibling.. and re-register for a new seasion.. (re-up the membership)
	
	 -->  


<f:view contentType="text/html">
    
 <h:head>
	 <f:facet name="first">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
        <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
     </f:facet>
	<f:metadata>
		<f:event type="preRenderView" listener="#{profileBean.verifyUserLogin()}" />
	</f:metadata>
</h:head>	    
<h:body>
<ui:composition template="/WEB-INF/templates/layout.xhtml">
<ui:define name="content">

 
<div id="page-div" width = "700px">

 <p:tabMenu activeIndex="1">  
    <p:menuitem value="My Information" url="manageprofile.xhtml"  />  
    <p:menuitem value="Scaha Membership" url="membermanagement.xhtml" icon="ui-icon-star" />  
    <p:menuitem value="Change Password" url="changepassword.xhtml"/>  
    <p:menuitem value="Manage Roles" url="manageroles.xhtml" />  
</p:tabMenu>  

<p:spacer width="10" height="10" />



  <h:form id="mp-form">

 	<h:panelGroup id="view-members" rendered="#{profileBean.isViewMembers()}">
   	
   		<p:fieldset id="fs1" toggleable="false" toggleSpeed="500">  
    	      <h:outputText style="font-size: 12px;" value="The following information is all the family members registered under your account.
    	                                          You can add more people to your account, but they have to FIRST be registered as a USA Hockey member."/>  
   		</p:fieldset>  

	  	<p:spacer width="10" height="10" />
	
		<p:fieldset id="fs1-1" toggleable="false" toggleSpeed="500">  
   	      	<h:outputText style="font-size: 12px;" value="The member information below applies to the following USA and SCAHA Hockey Seasons"/>  
 			<p:panelGrid id="season-ino" columns="2" cellpadding="3"> 
 				<h:outputText  value="Season Descriptsion" />
				<h:outputText  value="Days Left" />
				<h:outputText  value="#{profileBean.getCurrentSCAHAHockeySeason()}" />
				<h:outputText  value="12" />
				<h:outputText  value="#{profileBean.getCurrentUSAHockeySeason()}" />
				<h:outputText  value="12" />
			</p:panelGrid>
		</p:fieldset>  
	
		<p:spacer width="10" height="10" />
    
    	<h:outputText value="#{profileBean.getProfile().getPerson().getFam().getFamilyName()}"></h:outputText>
	
 	 	<p:spacer width="10" height="10" />
    
  		<!--  Here we need to implement at table model -->
  		<p:fieldset id="fs2" toggleable="false" toggleSpeed="500">  	      
			<p:dataTable var="familymember" value="#{profileBean.getFamilyMembers()}">  
   			    <p:column headerText="Name"><h:outputText value="#{familymember.getsFirstName()} #{familymember.getsLastName()}" /></p:column>  
   	    		<p:column headerText="Relationship"><h:outputText value="#{familymember.getRelationship()}" /></p:column>
   	    		<p:column headerText="DOB."><h:outputText value="#{familymember.getDob()}" /></p:column>  
   	    		<p:column headerText="CMPs"><h:outputText value="#{familymember.getMembertypes()}" /></p:column>  
   	    		<p:column headerText="#{profileBean.getCurrentUSAHockeySeason()}"><p:outputLabel style="font-family:monospace;!important" value="#{familymember.getUsaHockeyNumber()}" /></p:column>  
   	    		<p:column headerText="#{profileBean.getCurrentSCAHAHockeySeason()}"><p:outputLabel style="font-family:monospace;!important" value="#{familymember.getScahaHockeyNumber()}" /></p:column>  
   			</p:dataTable> 
    	</p:fieldset>
    			
		<p:spacer width="10" height="10" />
  	
  		<p:fieldset id="fs3" toggleable="false" toggleSpeed="500">  	      
	    	<p:commandButton value="Add A New Member" update="view-members,add-member" id="show-add-members" ajax="false"  
           actionListener="#{profileBean.setAddMembers()}"/>
        </p:fieldset>
    </h:panelGroup>
    
	<ui:fragment id="add-member" rendered="#{profileBean.isAddMember()}">
	 
	<p:fieldset id="fs11" toggleable="false" toggleSpeed="500">  
     <h:outputText style="font-size: 12px;" value="You will FIRST need to know the USAHockey Number for the CURRENT SEASON. Enter this in the provided field below, then click the SEARCH USAH.  
      If the record is found, the information below will be prefilled all the information.  Please review this information then click the SAVE button.  This will create a new member
 and generate a new member number for the year.  This member number will be needed to confirm you at all the SCAHA
 tryouts and is needed to sign any Club LOI electronically."/>  
   	</p:fieldset>  
	
	<p:spacer width="10" height="10" />
    
   	<h:outputText value="#{profileBean.getProfile().getPerson().getFam().getFamilyName()}"></h:outputText>

 	<p:spacer width="10" height="10" />	

  	<p:fieldset id="fs22" toggleable="false" toggleSpeed="500">  	
  	      
	    	<p:focus context="fs22"/>   
          <h:panelGrid id="add-member-grid" columns="3" cellpadding="3">  
            
				<p:outputLabel for="usah-reg" style="display: block;width:125px;!important" value="USA Hockey Number:"></p:outputLabel>
				<p:inputText id="usah-reg" style="width:100px;" value="#{usahBean.regnumber}" required="true" requiredMessage="Usa Hockey Number cannot be blank.">
					<f:validator validatorId="validateUSAHRegistration" />
				</p:inputText>
	 			<p:message id="m_usah-reg" closable="true" for="usah-reg"/>
				
			<p:outputLabel  for = "relationship" value="Relationship (select one)" /> 
       			<p:selectOneMenu id="relationship" value="#{usahBean.relationship}" style="width: 100px"  required="true" requiredMessage="need to select a relationship type." >         
            		<f:selectItem itemLabel="Child" itemValue="Child" />
            		<f:selectItem itemLabel="Self" itemValue="Self"/>
            		<f:selectItem itemLabel="Spouse" itemValue="Spouse"/>
            		<f:selectItem itemLabel="Parent" itemValue="Parent"/>
            		<f:selectItem itemLabel="Relative" itemValue="Relative"/>
            		<f:selectItem itemLabel="Other" itemValue="Other"/>
        		</p:selectOneMenu >  
 
 			<p:message id="m_relationship" closable="true" for="relationship"/>
 			
			<p:outputLabel  for = "member" value="Member Type (choose all that apply)" /> 
		 	   <p:selectManyCheckbox  id="member" value="#{usahBean.membertype}" style="width: 125px" required="true" requiredMessage="need to select a member type." >    
          			<f:selectItem itemLabel="Player-Skater" itemValue="Player-Skater" />  
          			<f:selectItem itemLabel="Player-Goalie" itemValue="Player-Goalie" />  
          			<f:selectItem itemLabel="Coach" itemValue="Coach"/>  
         			<f:selectItem itemLabel="Manager" itemValue="Manager"/>
      			</p:selectManyCheckbox>  
 			<p:message id="m_member" closable="true" for="member"/>

			</h:panelGrid>	
			
			<p:commandButton value="Search USAH" update="add-member" id="search-usah" ajax="false" actionListener="#{usahBean.fetchUSAHockey()}"/>
 	
 	</p:fieldset>  
	
	<p:spacer width="10" height="10" />
	
  	<p:fieldset id="fs222" toggleable="false" toggleSpeed="500">  	      
 
 		<table>
			<tr>
			<td>
			<h:panelGrid columns="2" cellpadding="3">  
            	<h:outputText style="display:block;width:100px;!important" value="First Name:" />
            	<h:outputText value="#{usahBean.getUsar().getFirstName()}" />
            	<h:outputText value="Last Name:" />
            	<h:outputText value="#{usahBean.getUsar().getLastName()}" />
            	<h:outputText value="Middle Init:" />
            	<h:outputText value="#{usahBean.getUsar().getMiddleInit()}" />
			</h:panelGrid>  
           	<p:separator id="separator23"/>
			<h:panelGrid columns="2" cellpadding="3"> 
				<h:outputText style="display:block;width:100px;!important" value="Address:" />
            	<h:outputText value="#{usahBean.getUsar().getAddress()}" />
				<h:outputText value="City:" />
            	<h:outputText value="#{usahBean.getUsar().getCity()}" />
				<h:outputText value="State, Country:" />
             	<h:outputText value="#{usahBean.getUsar().getState()}, #{usahBean.getUsar().getCountry()}" />
            	<h:outputText value="Zipcode:" />
            	<h:outputText value="#{usahBean.getUsar().getZipcode()} #{usahBean.getUsar().getForZip()}" />
            </h:panelGrid>  
            </td>
            <td>
			<h:panelGrid columns="2" cellpadding="3">  
            	<h:outputText style="display:block;width:100px;!important" value="DOB:" />
            	<h:outputText value="#{usahBean.getUsar().getDOB()}" />
            	<h:outputText value="Citizenship:" />
            	<h:outputText value="#{usahBean.getUsar().getCitizen()}" />
            	<h:outputText value="Gender:" />
            	<h:outputText value="#{usahBean.getUsar().getGender()}" />
			</h:panelGrid>  
           	<p:separator id="separator2"/>
			<h:panelGrid columns="2" cellpadding="3">  
				<h:outputText style="display:block;width:100px;!important" value="Parent/Guardian:" />
            	<h:outputText value="#{usahBean.getUsar().getPGSFName()} #{usahBean.getUsar().getPGSMName()} #{usahBean.getUsar().getPGSLName()}" />
            	<h:outputText value="Home Phone:" />
            	<h:outputText value="#{usahBean.getUsar().getHPhone()}" />
				<h:outputText value="Work Phone:" />
            	<h:outputText value="#{usahBean.getUsar().getBPhone()}" />
            	<h:outputText value="e-mail:" />
            	<h:outputText value="#{usahBean.getUsar().getEmail()}" />
            </h:panelGrid>  
            </td>
            </tr>
            </table>	
   
    </p:fieldset>
    
    <p:spacer width="10" height="10" />
	
  	<p:fieldset id="fs23" toggleable="false" toggleSpeed="500">  	      
       <h:panelGrid columns="3" cellpadding="3"> 
            <p:commandButton global="false" rendered="#{usahBean.datagood}" value="Save Now" update="add-member,view-members" id="finish-add-mem" ajax="false" action="#{usahBean.addNewMember()}"/> 
           	 <p:message rendered="#{usahBean.datagood}" id="m_finish-add-mem" closable="true" for="finish-add-mem"/>
           	<p:commandButton value="Cancel" update="add-member" id="cancel-add-mem" immediate="true" ajax="false" action="#{profileBean.cancelAddMember()}" >
            	<p:resetInput target="mp-form" />
            </p:commandButton>
           	 
		</h:panelGrid>
	</p:fieldset>
	</ui:fragment>            
 </h:form>		
 </div>
</ui:define>
</ui:composition>
</h:body>
</f:view>
</html>